---
title: Signature spec
---

# Signature spec

## Introduction

A Univrse Signature is a structure attached to an Envelope, containing a set of headers and a cryptographic signature (or MAC). An Envelope may contain one or multiple Signature structures.

The Signature structure headers must contain an `alg` header and may contain a `kid` header, to help other parties understand what key and algorithm was used to generate the signature or MAC. Once understood, the observing party can verify the signature contained in the structure.

## Structure

A Univrse Signature described using Concise Data Definition Language:

```elixir
Signature = [
  header: Header,
  signature: bytes
]

Header = {
  alg: text,
  ? kid: text,
  * text => any
}
```

## Headers

A Univrse Signature may contain any of the following headers. It may also contain any other arbitrary headers.

| Header | Description         | Required |
| ------ | ------------------- | -------- |
| `alg`  | Signature algorithm | âœ…       |
| `kid`  | Key ID              |          |

## Algorithms

The following algorithms can be used with Univrse Signatures.

| Algorithm    | Description                        | Key type |
| ------------ | ---------------------------------- | -------- |
| `HS256`      | HMAC using SHA-256                 | `oct`    |
| `HS512`      | HMAC using SHA-512                 | `oct`    |
| `ES256K`     | ECDSA signature on secp256k1 curve | `EC`     |
| `ES256K-BSM` | Bitcoin Signed Message algorithm   | `EC`     |

For all algorithms, the signing input consists of the Envelope headers and payload, serialised as a CBOR-encoded binary.

### `HS256` - HMAC using SHA-256

A `HMAC SHA-256` MAC is generated per [RFC 2104](https://datatracker.ietf.org/doc/html/rfc2104), using `SHA-256` as the hash algorithm and using an `oct` key 256 bits long.

The result is a 32 byte signature. The signature is validated by generating a MAC as above using the same key, and comparing the result with the Univrse Signature value.

### `HS512` - HMAC using SHA-512

A `HMAC SHA-512` MAC is generated per [RFC 2104](https://datatracker.ietf.org/doc/html/rfc2104), using `SHA-512` as the hash algorithm and using an `oct` key 512 bits long.

The result is a 64 byte signature. The signature is validated by generating a MAC as above using the same key, and comparing the result with the Univrse Signature value.

### `ES256K` - ECDSA signature on secp256k1 curve

A signature is generated by using the `SHA-256` hash algorithm on the signing input, and creating an ECDSA signature on the `secp256k1` curve using an `EC` key. Implementations should use a deterministic algorithm to generate the ECDSA nonce, k, such as the algorithm defined in [RFC6979](https://datatracker.ietf.org/doc/html/rfc6979).

The result is a 65 byte compact signature. The signature can be verified using the same `EC` public key.

### `ES256K-BSM` - Bitcoin Signed Message algorithm

This algorithm is similar to `ES256K`, with the following differences: The signing input is first prefixed with the string `"Bitcoin Signed Message:\n"`, and then hashed TWICE using the `SHA-256` algorithm.

This algorithm is commonly used in the SDKs of popular web wallets such as Money Button and Relay.
